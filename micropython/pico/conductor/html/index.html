<!DOCTYPE html>
<html>
    <body>
        <h1>Kinetic Display Controls Settings</h1>

        <form id="controllersettings">
            <table>
                <tr>
                    <td>Schedule</td>
                    <td><select name="schedule" id="schedule"><option value="schedule_0.json" data-id="All Features" selected>All Features</option><option value="schedule_1.json" data-id="Date, Internal and External Temperature and Humidity" >Date, Internal and External Temperature and Humidity</option><option value="schedule_2.json" data-id="Time and Date" >Time and Date</option><option value="schedule_3.json" data-id="All features in one minute" >All features in one minute</option><option value="schedule_4.json" data-id="Time only" >Time only</option> </select></td>
                </tr>
                <tr>
                    <td>Add Schedule</td>
                    <td><a href="/uploadfile"><button type="button">Upload Schedule</button></a></td>
                </tr>
                <tr>
                    <td>Delete Schedule</td>
                    <td><a href="#" onclick="deleteSchedule(event)"><button type="button">Delete Schedule</button></a></td>
                </tr>
                <tr>
                    <td><p></p></td>
                    <td><p></p></td>
                </tr>
                <tr>
                    <td>Wifi SSID</td>
                    <td><input type="text" id="ssid" name="ssid" maxlength="24" size="24" value="ssid-name"></td>
                </tr>
                <tr>
                    <td>Wifi Pwd</td>
                    <td><input type="password" id="pwd" name="pwd" maxlength="24" size="24" value="wifi-password"></td>
                </tr>
                <tr>
                    <td>Time</td>
                    <td><select name="time" id="time">
                        <option value="12" selected>12</option>
                        <option value="24">24</option>
                    </select></td>
                </tr>
                <tr>
                    <td>Temperature</td>
                    <td><select name="tempCF" id="tempCF">
                        <option value="F">fahrenheit</option>
                        <option value="C">celsius</option>
                    </select></td>
                </tr>
                <tr>
                    <td>Time Zone</td>
                    <td><input type="text" id="timeZone" value="" name="timeZone" placeholder="Europe/London" maxlength="30" size="24"></td>
                </tr>
                <tr>
                    <td>Display Motor Wait Time</td>
                    <td><input type="number" id="wait" name="wait" value="16" name="wait" min="15" max="30"> milliseconds</td>
                </tr>
                <tr>
                    <td>Display Motor Speed</td>
                    <td><input type="number" id="speed" name="speed" value="85" name="speed" min="50" max="99"> percent</td>
                </tr>
            </table>
            <p></p><input type="submit" value="Save" onclick="upload(event)">
        </form>
        <script>
            async function upload(ev) {
                ev.preventDefault();
                const data = JSON.stringify({
                    wait: document.getElementById('wait').value,
                    speed: document.getElementById('speed').value,
                    ssid: document.getElementById('ssid').value,
                    pwd: document.getElementById('pwd').value,
                    time: document.getElementById('time').value,
                    tempCF: document.getElementById('tempCF').value,
                    timeZone: document.getElementById('timeZone').value,
                    schedule: document.getElementById('schedule').value,
                });
        
                await fetch('/controllersettings', {
                    method: 'POST',
                    body: data,
                    headers: {
                        'Content-Type': 'application/json',
                    },
                }).then(res => {
                    console.log('Upload accepted');
                    window.location.href = '/bye';
                }).catch(err => {
                    console.error('Error saving settings:', err);
                });
            }

            async function deleteSchedule(ev) {
                ev.preventDefault();
                const schedule = document.getElementById('schedule').value;
                
                await fetch(`/delete/${schedule}`, {
                    method: 'DELETE',
                }).then(res => {
                    console.log('Schedule deleted');
                    window.location.reload();
                });
            }
        </script>
    </body>
</html>